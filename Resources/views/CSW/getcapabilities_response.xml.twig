<?xml version="1.0" encoding="UTF-8"?>
<csw:Capabilities version="2.0.2"
                  xmlns:csw="http://www.opengis.net/cat/csw/2.0.2"
                  xsi:schemaLocation="http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd"
                  xmlns:gml="http://www.opengis.net/gml" xmlns:gmd="http://www.isotc211.org/2005/gmd"
                  xmlns:ows="http://www.opengis.net/ows" xmlns:ogc="http://www.opengis.net/ogc"
                  xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    {% if getcap.section|length == 0 or 'ServiceIdentification' in getcap.section %}
        <ows:ServiceIdentification>
            {% if getcap.entity.abstract is defined %}
                <ows:Title>{{ getcap.entity.title }}</ows:Title>
            {% endif %}
            {% if getcap.entity.abstract is defined %}
                <ows:Abstract>{{ getcap.entity.abstract }}</ows:Abstract>
            {% endif %}
            {% if getcap.entity.keywords | length > 0 %}
                <ows:Keywords>
                    {% for keyword in getcap.entity.keywords %}
                        <ows:Keyword>{{ keyword }}</ows:Keyword>
                    {% endfor %}
                </ows:Keywords>
            {% endif %}
            <ows:ServiceType>CSW</ows:ServiceType>
            <ows:ServiceTypeVersion>2.0.2</ows:ServiceTypeVersion>
            {% if getcap.entity.fees is defined %}
                <ows:Fees>{{ getcap.entity.fees }}</ows:Fees>
            {% endif %}
            {% if getcap.entity.accessConstraints | length > 0 %}
                {% for accessConstraint in getcap.entity.accessConstraints %}
                    <ows:AccessConstraints>{{ accessConstraint }}</ows:AccessConstraints>
                {% endfor %}
            {% endif %}
        </ows:ServiceIdentification>
    {% endif %}
    {% if getcap.section|length == 0 or 'ServiceProvider' in getcap.section %}
        <ows:ServiceProvider>
            <ows:ProviderName>{{ getcap.entity.providerName }}</ows:ProviderName>
            {% if getcap.entity.providerSite is defined %}
                <ows:ProviderSite xlink:type="simple" xlink:href="{{ getcap.entity.providerSite }}"/>
            {% endif %}
            <ows:ServiceContact>
                <ows:IndividualName>{{ getcap.entity.individualName }}</ows:IndividualName>
                <ows:PositionName>{{ getcap.entity.positionName }}</ows:PositionName>
                <ows:ContactInfo>
                    {% if getcap.entity.phoneVoice is defined or getcap.entity.phoneFacsimile is defined %}
                        <ows:Phone>
                            {% if getcap.entity.phoneVoice is defined %}
                                <ows:Voice>{{ getcap.entity.phoneVoice }}</ows:Voice>
                            {% endif %}
                            {% if getcap.entity.phoneFacsimile is defined %}
                                <ows:Facsimile>{{ getcap.entity.phoneFacsimile }}</ows:Facsimile>
                            {% endif %}
                        </ows:Phone>
                    {% endif %}
                    {% if getcap.entity.deliveryPoint != '' or getcap.entity.city != '' or getcap.entity.administrativeArea != '' or getcap.entity.postalCode != '' or getcap.entity.country != '' or getcap.entity.electronicMailAddress != '' %}
                        <ows:Address>
                            <ows:DeliveryPoint>{{ getcap.entity.deliveryPoint }}</ows:DeliveryPoint>
                            <ows:City>{{ getcap.entity.city }}</ows:City>
                            <ows:AdministrativeArea>{{ getcap.entity.administrativeArea }}</ows:AdministrativeArea>
                            <ows:PostalCode>{{ getcap.entity.postalCode }}</ows:PostalCode>
                            <ows:Country>{{ getcap.entity.country }}</ows:Country>
                            <ows:ElectronicMailAddress>{{ getcap.entity.electronicMailAddress }}</ows:ElectronicMailAddress>
                        </ows:Address>
                    {% endif %}
                    {% if getcap.entity.onlineResourse != '' %}
                        <ows:OnlineResource xlink:href="{{ getcap.entity.onlineResourse }}"/>
                    {% endif %}
                </ows:ContactInfo>
            </ows:ServiceContact>
        </ows:ServiceProvider>
    {% endif %}
    {% if getcap.section|length == 0 or 'OperationsMetadata' in getcap.section %}
        <ows:OperationsMetadata>
            <ows:Operation name="GetCapabilities">
                <ows:DCP>
                    <ows:HTTP>
                        <ows:Get xlink:href="{{ getcap.urlBasic }}?"/>
                        <ows:Post xlink:href="{{ getcap.urlBasic }}"/>
                    </ows:HTTP>
                </ows:DCP>
                <ows:Parameter name="sections">
                    <ows:Value>ServiceIdentification</ows:Value>
                    <ows:Value>ServiceProvider</ows:Value>
                    <ows:Value>OperationsMetadata</ows:Value>
                    <ows:Value>Filter_Capabilities</ows:Value>
                </ows:Parameter>
                <ows:Constraint name="PostEncoding">
                    <ows:Value>XML</ows:Value>
                </ows:Constraint>
            </ows:Operation>
            <ows:Operation name="DescribeRecord">
                <ows:DCP>
                    <ows:HTTP>
                        <ows:Get xlink:href="{{ getcap.urlBasic }}?"/>
                        <ows:Post xlink:href="{{ getcap.urlBasic }}"/>
                    </ows:HTTP>
                </ows:DCP>
                <ows:Parameter name="typeName">
                    <ows:Value>gmd:MD_Metadata</ows:Value>
                </ows:Parameter>
                <ows:Parameter name="outputFormat">
                    <ows:Value>application/xml</ows:Value>
                </ows:Parameter>
                <ows:Parameter name="schemaLanguage">
                    <ows:Value>http://www.w3.org/TR/xmlschema-1/</ows:Value>
                </ows:Parameter>
                <ows:Parameter name="typeName">
                    <ows:Value>gmd:MD_Metadata</ows:Value>
                </ows:Parameter>
                <ows:Constraint name="PostEncoding">
                    <ows:Value>XML</ows:Value>
                </ows:Constraint>
            </ows:Operation>
            <ows:Operation name="GetRecordById">
                <ows:DCP>
                    <ows:HTTP>
                        <ows:Get xlink:href="{{ getcap.urlBasic }}?"/>
                        <ows:Post xlink:href="{{ getcap.urlBasic }}"/>
                    </ows:HTTP>
                </ows:DCP>
                <ows:Parameter name="outputSchema">
                    <ows:Value>http://www.isotc211.org/2005/gmd</ows:Value>
                </ows:Parameter>
                <ows:Parameter name="outputFormat">
                    <ows:Value>application/xml</ows:Value>
                </ows:Parameter>
                <ows:Parameter name="resultType">
                    <ows:Value>hits</ows:Value>
                    <ows:Value>results</ows:Value>
                    <ows:Value>validate</ows:Value>
                </ows:Parameter>
                <ows:Parameter name="ElementSetName">
                    <ows:Value>brief</ows:Value>
                    <ows:Value>summary</ows:Value>
                    <ows:Value>full</ows:Value>
                </ows:Parameter>
                <ows:Constraint name="PostEncoding">
                    <ows:Value>XML</ows:Value>
                </ows:Constraint>
            </ows:Operation>
            <ows:Operation name="GetRecords">
                <ows:DCP>
                    <ows:HTTP>
                        <ows:Get xlink:href="{{ getcap.urlBasic }}?"/>
                        <ows:Post xlink:href="{{ getcap.urlBasic }}"/>
                    </ows:HTTP>
                </ows:DCP>
                <ows:Parameter name="resultType">
                    <ows:Value>hits</ows:Value>
                    <ows:Value>results</ows:Value>
                    <ows:Value>validate</ows:Value>
                </ows:Parameter>
                <ows:Parameter name="outputFormat">
                    <ows:Value>application/xml</ows:Value>
                </ows:Parameter>
                <ows:Parameter name="outputSchema">
                    <ows:Value>http://www.isotc211.org/2005/gmd</ows:Value>
                </ows:Parameter>
                <ows:Parameter name="typeNames">
                    <ows:Value>gmd:MD_Metadata</ows:Value>
                </ows:Parameter>
                <ows:Parameter name="CONSTRAINTLANGUAGE">
                    <ows:Value>FILTER</ows:Value>
                </ows:Parameter>
                <ows:Constraint name="PostEncoding">
                    <ows:Value>XML</ows:Value>
                </ows:Constraint>
                <ows:Constraint name="SupportedISOQueryables">
                    <!--ows:Value>Operation</ows:Value>
                    <ows:Value>Format</ows:Value>
                    <ows:Value>OrganisationName</ows:Value>
                    <ows:Value>Type</ows:Value>
                    <ows:Value>ServiceType</ows:Value>
                    <ows:Value>DistanceValue</ows:Value>
                    <ows:Value>ResourceLanguage</ows:Value>
                    <ows:Value>RevisionDate</ows:Value>
                    <ows:Value>OperatesOn</ows:Value>
                    <ows:Value>GeographicDescriptionCode</ows:Value>
                    <ows:Value>AnyText</ows:Value>
                    <ows:Value>Modified</ows:Value>
                    <ows:Value>PublicationDate</ows:Value>
                    <ows:Value>ResourceIdentifier</ows:Value>
                    <ows:Value>ParentIdentifier</ows:Value>
                    <ows:Value>Identifier</ows:Value>
                    <ows:Value>CouplingType</ows:Value>
                    <ows:Value>TopicCategory</ows:Value>
                    <ows:Value>OperatesOnIdentifier</ows:Value>
                    <ows:Value>ServiceTypeVersion</ows:Value>
                    <ows:Value>TempExtent_end</ows:Value>
                    <ows:Value>Subject</ows:Value>
                    <ows:Value>CreationDate</ows:Value>
                    <ows:Value>OperatesOnName</ows:Value>
                    <ows:Value>Title</ows:Value>
                    <ows:Value>DistanceUOM</ows:Value>
                    <ows:Value>Denominator</ows:Value>
                    <ows:Value>AlternateTitle</ows:Value>
                    <ows:Value>Language</ows:Value>
                    <ows:Value>TempExtent_begin</ows:Value>
                    <ows:Value>HasSecurityConstraints</ows:Value>
                    <ows:Value>KeywordType</ows:Value>
                    <ows:Value>Abstract</ows:Value-->
                </ows:Constraint>
                <ows:Constraint name="AdditionalQueryables">
                    <!--ows:Value>Relation</ows:Value>
                    <ows:Value>AccessConstraints</ows:Value>
                    <ows:Value>ResponsiblePartyRole</ows:Value>
                    <ows:Value>OnlineResourceMimeType</ows:Value>
                    <ows:Value>OnlineResourceType</ows:Value>
                    <ows:Value>Lineage</ows:Value>
                    <ows:Value>SpecificationDate</ows:Value>
                    <ows:Value>ConditionApplyingToAccessAndUse</ows:Value>
                    <ows:Value>SpecificationDateType</ows:Value>
                    <ows:Value>MetadataPointOfContact</ows:Value>
                    <ows:Value>Classification</ows:Value>
                    <ows:Value>Date</ows:Value>
                    <ows:Value>OtherConstraints</ows:Value>
                    <ows:Value>Degree</ows:Value>
                    <ows:Value>SpecificationTitle</ows:Value-->
                </ows:Constraint>
            </ows:Operation>
        </ows:OperationsMetadata>
    {% endif %}
    {% if getcap.section|length == 0 or 'Filter_Capabilities' in getcap.section %}

        {#{% if getcap.sections.Filter_Capabilities is defined %}#}
        {#<ogc:Filter_Capabilities>#}
        {#{% set filter =  getcap.sections.Filter_Capabilities.data %}#}
        {#{% if filter.spatial_Capabilities is defined %}#}
        {#<ogc:Spatial_Capabilities>#}
        {#{% if filter.spatial_Capabilities.geometryOperands|length > 0 %}#}
        {#<ogc:GeometryOperands>#}
        {#{% for operand in filter.spatial_Capabilities.geometryOperands %}#}
        {#<ogc:GeometryOperand>{{ operand }}</ogc:GeometryOperand>#}
        {#{% endfor %}#}
        {#</ogc:GeometryOperands>#}
        {#{% else %}#}
        {#<ogc:GeometryOperands/>#}
        {#{% endif %}#}
        {#{% if filter.spatial_Capabilities.spatialOperators|length > 0 %}#}
        {#<ogc:SpatialOperators>#}
        {#{% for operand in filter.spatial_Capabilities.spatialOperators %}#}
        {#<ogc:SpatialOperator name="{{ operand }}"/>#}
        {#{% endfor %}#}
        {#</ogc:SpatialOperators>#}
        {#{% else %}#}
        {#<ogc:SpatialOperators/>#}
        {#{% endif %}#}
        {#</ogc:Spatial_Capabilities>#}
        {#{% endif %}#}
        {#{% if filter.scalar_Capabilities is defined %}#}
        {#<ogc:Scalar_Capabilities>#}
        {#{% if filter.scalar_Capabilities.logicalOperators %}#}
        {#<ogc:LogicalOperators/>#}
        {#{% endif %}#}
        {#{% if filter.scalar_Capabilities.comparisonOperators|length > 0 %}#}
        {#<ogc:ComparisonOperators>#}
        {#{% for operand in filter.scalar_Capabilities.comparisonOperators %}#}
        {#<ogc:ComparisonOperator>{{ operand }}</ogc:ComparisonOperator>#}
        {#{% endfor %}#}
        {#</ogc:ComparisonOperators>#}
        {#{% endif %}#}
        {#</ogc:Scalar_Capabilities>#}
        {#{% endif %}#}
        {#{% if filter.id_Capabilities is defined %}#}
        {#<ogc:Id_Capabilities>#}
        {#<ogc:FID/>#}
        {#</ogc:Id_Capabilities>#}
        {#{% endif %}#}
        {#</ogc:Filter_Capabilities>#}
    {% endif %}


</csw:Capabilities>
