<?xml version="1.0" encoding="UTF-8"?>
<csw:GetRecordsResponse xmlns:ows="http://www.opengis.net/ows"  xmlns:csw="http://www.opengis.net/cat/csw/2.0.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd">
{% if getrecords.requestId is defined %}
  <csw:RequestId>{{ timestamp }}</csw:RequestId>
{% endif %}
  <csw:SearchStatus timestamp="{{timestamp}}" />
{% if getrecords.resultType == constant('Plugins\\WhereGroup\\CatalogueServiceBundle\\Component\\GetRecords::RESULTTYPE_HITS') or matched == 0 %}
  <csw:SearchResults numberOfRecordsMatched="{{matched}}" numberOfRecordsReturned="{{returned}}" elementSet="{{getrecords.elementSetName}}" nextRecord="{{nextrecord}}" />
{% else %}
  <csw:SearchResults numberOfRecordsMatched="{{matched}}" numberOfRecordsReturned="{{returned}}" elementSet="{{getrecords.elementSetName}}" nextRecord="{{nextrecord}}">
{% set S = constant('Plugins\\WhereGroup\\CatalogueServiceBundle\\Component\\GetRecords::ELEMENTSET_SUMMARY') %}
{% set F = constant('Plugins\\WhereGroup\\CatalogueServiceBundle\\Component\\GetRecords::ELEMENTSET_FULL') %}
{% set B = constant('Plugins\\WhereGroup\\CatalogueServiceBundle\\Component\\GetRecords::ELEMENTSET_BRIEF') %}
{% for record in records %}
 {% if getrecords.outputSchema == 'http://www.isotc211.org/2005/gmd' %}
  {%if getrecords.elementSetName == B %}
   {% include 'CatalogueServiceBundle:CSW:record_iso_brief.xml.twig' with {'p': record.getObject } %}
  {% elseif getrecords.elementSetName == S %}
   {% include 'CatalogueServiceBundle:CSW:record_iso_full.xml.twig' with {'p': record.getObject } %}
  {% elseif getrecords.elementSetName == F %}
   {% include 'CatalogueServiceBundle:CSW:record_iso_full.xml.twig' with {'p': record.getObject } %}
  {% endif %}
 {% elseif getrecords.outputSchema == 'http://www.opengis.net/cat/csw/2.0.2' %}
  {%if getrecords.elementSetName == B %}
   {% include 'CatalogueServiceBundle:CSW:record_dc_brief.xml.twig' with {'p': record.getObject } %}
  {% elseif getrecords.elementSetName == S %}
   {% include 'CatalogueServiceBundle:CSW:record_dc_summary.xml.twig' with {'p': record.getObject } %}
  {% elseif getrecords.elementSetName == F %}
   {% include 'CatalogueServiceBundle:CSW:record_dc_full.xml.twig' with {'p': record.getObject } %}
  {% endif %}
 {% endif %}
{% endfor %}
  </csw:SearchResults>
{% endif %}
</csw:GetRecordsResponse>